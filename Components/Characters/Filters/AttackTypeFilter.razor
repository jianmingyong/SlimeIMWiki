@using SlimeIMWiki.Services
@inherits BaseFilterComponent

<FilterComponent Key="@($"{nameof(AttackType)}_{AttackType.Name}")" DisplayText="@AttackType.Name"
                 IsRemoveMode="IsRemoveMode" OnClick="Execute">
    <Image Class="filterIcon" Source="@AttackType.Icon" Width="Width.Em(1.5)" Height="Height.Em(1.5)"/>
</FilterComponent>

@code
{
    [Parameter]
    [EditorRequired]
    public required IAttackType AttackType { get; set; }

    protected override void OnInitialized()
    {
        Filter ??= new Filter($"{nameof(AttackType)}_{AttackType.Name}", unit =>
            {
                return unit switch
                {
                    BattleUnit battleUnit => battleUnit.AttackType == AttackType.Name,
                    ProtectionUnit protectionUnit => protectionUnit.AttackType == AttackType.Name,
                    var _ => false
                };
            },
            @<AttackTypeFilter AttackType="AttackType" IsRemoveMode="true" Filter="Filter"/>);

        base.OnInitialized();
    }
}