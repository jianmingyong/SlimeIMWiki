@using SlimeIMWiki.Components.Characters.Filters
@inherits ReactiveInjectableComponentBase<SlimeIMWiki.ViewModels.Characters.FilterSectionViewModel>

@{ Debug.Assert(ViewModel != null, nameof(ViewModel) + " != null"); }

<Div Flex="Flex.Wrap.JustifyContent.End.OnTablet.AlignContent.End.OnTablet" Width="Width.Is100"
     Margin="Margin.Is2.FromBottom">
    <Switch TValue="bool" @bind-Checked="ViewModel.IsOrFilter">OR Filters Toggle (Uncheck for AND Filters)</Switch>
</Div>

<Div Flex="Flex.Column" Gap="Gap.Is2" Background="Background.Body" Margin="Margin.Is2.FromBottom">
    <Div Flex="Flex.Wrap.JustifyContent.Center.AlignContent.Center" Gap="Gap.Is2">
        @foreach (var attackType in ViewModel.AttackTypes)
        {
            <AttackTypeFilter AttackType="attackType"/>
        }

        <Span>|</Span>

        @foreach (var attribute in ViewModel.Attributes)
        {
            <AttributeFilter Attribute="attribute"/>
        }
    </Div>

    <Div Flex="Flex.Wrap.JustifyContent.Center.AlignContent.Center" Gap="Gap.Is2">
        <InitialRarityFilter Rarity="3"/>

        <Span>|</Span>

        <InitialRarityFilter Rarity="4"/>

        <Span>|</Span>

        <InitialRarityFilter Rarity="5"/>
    </Div>
</Div>

<Div Flex="Flex.Column" Gap="Gap.Is2" Background="Background.Body" Margin="Margin.Is2.FromBottom">
    <Dropdown>
        <DropdownToggle Color="Color.Dark" Border="Border.White">Forces</DropdownToggle>
        <DropdownMenu MaxMenuHeight="50vh" Background="Background.Dark">
            @foreach (var forceGroup in ViewModel.Forces.GroupBy(force => force.Category))
            {
                <DropdownHeader TextColor="TextColor.White50">@forceGroup.Key</DropdownHeader>

                @foreach (var force in forceGroup)
                {
                    <DropdownItem TextColor="TextColor.Light">
                        <ForceFilter Force="force"/>
                    </DropdownItem>
                }

                <DropdownDivider/>
            }
        </DropdownMenu>
    </Dropdown>
</Div>

<Div Flex="Flex.Wrap" Gap="Gap.Is2">
    @foreach (var filter in ViewModel.Filters)
    {
        @filter.RemoveRenderFragment
    }
</Div>
